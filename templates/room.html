{% extends 'base.html' %}
{% block content %}
<div class = "timer"> Timer
<div id="timer">00:00:00</div>
    <button onclick="startTimer()">Start</button>
    <button onclick="stopTimer()">Stop</button>
    <button onclick="resetTimer()">Reset</button>

    <script src="{{ url_for('static', filename='timer.js') }}"></script>
</div>
<div class="whiteboard">Whiteboard
    <canvas id="whiteboardCanvas" height="500" width="500"></canvas>
    <button onclick="clearCanvas()">Clear</button>
</div>

<script src="{{ url_for('static', filename='timer.js') }}"></script>
<script src="{{ url_for('static', filename='whiteboard.js') }}"></script>
<script>
    window.addEventListener('load', function () {
        initWhiteboard();
    });
</script>
</div>
</div>
<div class = "message-box">
    <h2>Chat Code: {{code}}</h2>
    <div class = "messages" id="messages"> </div>
    <div class = "inputs">
        <input type = "text" rows = "3" placeholder="Message" name = "message" id = "message"/>
        <button type = "button" name = "send" id = "sent-btn" onClick = "sendMessage()">
            Send 
        </button>
    </div>
</div>
<script type = "text/javascript">
    var socketio = io();
    const messages = document.getElementById("messages")
    const createMessage = (name, msg, time) => {
        const content = `
        <div class = "text">
        <div>
            <span>
                <strong>${name}</strong>: ${msg}
            </span>
            <span class = "muted">
                ${time}
        </div>

        `;
        messages.innerHTML += content;
    }
    socketio.on("message", (data) => {
        createMessage(data.name, data.message);
    });
    const sendMessage = () => {
        const message = document.getElementById("message")
        if (message.value == "") return;
        socketio.emit("message", {data: message.value})
        message.value = "";
    }
</script>
{% for msg in messages %}
    <script> type = "text/javascript"
        createMessage("{{msg.name}}", "{{msg.message}}");
    </script>
{% endfor %}
{% endblock %}